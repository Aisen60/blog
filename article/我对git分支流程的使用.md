### 前言

还记得刚毕业出来去一家企业实习的时候，开发团队也只有 7 个人，代码管理系统用的是 svn，后来过了一段时间，改成了 git。当时使用 git 的时候没有进行很好的代码管理，只有 master 分支。所以会经常出现代码覆盖，版本很难回滚，很难定位到 bug 所在的版本，并且有新的需求就往上加，导致对代码的管理很困难，也导致了项目迭代的困难。后来我实习结束离开的时候，依旧没有解决这个问题。

后来我去到新的企业，也有这种现象存在，大概过了 2 个月左右，来了新的总监。总监对代码管理和项目管理比较看重，制订了一套规范和流程。后来才慢慢的对 git 的使用有了比较深的理解。

### 分支的介绍

图片来源于：[https://nvie.com/posts/a-successful-git-branching-model/](https://note.youdao.com/)

![分支模型](https://nvie.com/img/git-model@2x.png)

我在平时的工作中和学习中主要使用到的分支：

**master**

- 这个分支的代码是目前生产环境运行的代码。
- 这个分支的代码一般是由 develop 分支和 hotfix 分支合拼完成的。
- 这个分支的代码是不能在任何时间修改的。要保持 master 分支的稳定性。

**develop**

- 这个分支的代码始终是项目的最新代码，包含了完成新功能的开发和 bug 的修改。

**feature**

- 这个分支的代码主要是新功能的开发。
- feature 分支是以 develop 分支为基础创建的。
- 命名分支：一般以 feature/开头，例如：feature/module、feature/content。公司项目我都是以 feature/姓名拼音全称，这样命名。

**release**

- 这个分支的代码是预上线代码，提交测试阶段，会以 release 分支代码为基准提测。

  当新的功能开发完成后，由 feature 分支合拼到 develop 分支，进入提测时，会以 develop 分支为基础创建 release 分支。

  release 分支的命名一般以 release/开头，后面加上模块名或者日期。

  如果测试过程中有 bug 需要修复，那么直接在 release 分支修复，并且提交测试。

  当测试完成后，把 release 分支的代码合拼到 master 和 develop 分支。

  此时 master 分支用于部署生产环境的代码。

  tips:因为 release 分支是由 develop 分支为基础的所创建的，测试完成后，可以认为达到了生产环境的版本了。

**hotfix**

- 这个分支的代码主要是解决线上的紧急 bug 的，以 master 分支为基础创建的，命名的规则可以和 feature 一样。
- 当解决完 bug 后，需要合拼到 master 分支和 develop 分支。

### 场景设想

1、老大安排了新的需求，需要做一个用户系统，要求一周内完成并且需要部署上线。你看看有没有当期有没有新需求的分支（多人协作，有可能你的同事已经创建了），如果没有那就创建一个 feature 分支，命名为"feature/user_module"。如果有当前分支了，那不用创建直接拉取当前这个代码的分支。

2、3 天过去了，你做完了这个新的需求，自己也自测通过了，需要提交测试了。首先，先把 feature/user_module 合拼到 develop 分支。合拼完后，在以 develop 分支为基础创建 release 分支，命名为"release/user_module"。创建这个 release/user_module 分支的目的是为了解决测试所提出的 bug。

3、测试人员提出了好几个 bug，然后在 release/user_module 分支上修改，修改完后在此提测。如果还有 bug 那么也在这个分支上修改提测。一直到没有 bug 了。

4、一周来到了最后一天晚上了，老大说准备部署生产环境了。这个时候就可以把 release/user_module 分支合拼到 master 和 develop 分支上了。部署之前，老大会打一个 tag 标签，以便回退到当前的这个版本。

5、做完了这个需求，下面或许还有很多需求，那么可以继续按照上面的流程来。

6、第二天或者第 n 天后，客户反馈有个 bug 或者有个按钮或者数据出不来，你定位到了问题后，也与团队内的同事或者老大确认过后，需要紧急处理。这个时候以 master 为基础创建 hotfix 分支，命名为"hotfix/user_module"分支，修改并且验证完这个 bug 后，把代码合拼到 master 和 develop 分支上，部署之前打个 tag，并且部署生产环境。

**上面的分支流程是我在平时工作和学习中所使用的，每个企业和团队的流程大大小小的都不同，但是整体的流程都差不多。如果你的企业团队有分支流程规范，那么应该按照规范来走。**
